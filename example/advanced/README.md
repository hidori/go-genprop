# Advanced Example - Validation Support

This example demonstrates go-genprop with validation integration using go-playground/validator.

## Files

- `user.go` - Struct definition with validation tags
- `user_prop.go` - Generated property methods (auto-generated)
- `../cmd/example/advanced/main.go` - Usage example

## Features Demonstrated

- Private setters with `property:"set=private"`
- Custom validation function integration
- Error handling in property setters
- Manual constructor with validation

## Struct Definition

```go
package example

import (
    "github.com/go-playground/validator/v10"
    "github.com/pkg/errors"
)

// User represents a user with validation-enabled fields.
type User struct {
    id    int    `property:"get"`                                       // Read-only ID field
    name  string `property:"get,set"`                                   // Name with both getter and setter
    email string `property:"get,set=private" validate:"required,email"` // Email with private setter and validation
}

var _validator = validator.New()

// NewUser creates a new User instance with validation.
func NewUser(id int, name, email string) (*User, error) {
    user := &User{id: id}
    user.SetName(name)

    if err := user.setEmail(email); err != nil {
        return nil, err
    }

    return user, nil
}

// validateFieldValue validates a field value using the specified validation tag.
func validateFieldValue(name string, v any, tag string) error {

    if err := _validator.Var(v, tag); err != nil {

        return errors.Wrapf(err, "validation failed for field '%s'", name)
    }

    return nil
}
```

## Code Generation

```bash
go tool genprop user.go > user_prop.go
```

## Generated Output

```go
// Code generated by github.com/hidori/go-genprop/cmd/genprop DO NOT EDIT.
package example

func (t *User) GetID() int {
    return t.id
}
func (t *User) GetName() string {
    return t.name
}
func (t *User) SetName(v string) {
    t.name = v
}
func (t *User) GetEmail() string {
    return t.email
}
func (t *User) setEmail(v string) error {
    err := validateFieldValue("email", v, "required,email")
    if err != nil {
        return err
    }
    t.email = v
    return nil
}
```

## Usage Example

```go
// Create a new user with validation
user, err := NewUser(1, "John Doe", "john@example.com")
if err != nil {
    log.Fatal(err)
}

// Access values using getters
fmt.Printf("User ID: %d\n", user.GetID())         // Output: User ID: 1
fmt.Printf("User Name: %s\n", user.GetName())     // Output: User Name: John Doe
fmt.Printf("User Email: %s\n", user.GetEmail())   // Output: User Email: john@example.com

// Update values using setters with validation
user.SetName("Jane Smith")

// Note: setEmail is private, so it can only be called from within the package
// This demonstrates validation with private setters for controlled access
```

## Key Points

- Email field uses `set=private` to create a private setter `setEmail()`
- Custom `validateFieldValue` function provides validation logic
- Manual constructor `NewUser` handles validation during initialization
- Error handling is built into validated setters
